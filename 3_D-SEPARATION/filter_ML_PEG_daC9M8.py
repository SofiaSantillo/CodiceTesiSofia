import re
from collections import defaultdict

class DAG:
    def __init__(self, edges):
        self.edges = edges
        self.graph = defaultdict(list)
        self.parents = defaultdict(list)
        for u, v in edges:
            self.graph[u].append(v)
            self.parents[v].append(u)

    def all_paths(self, start, end):
        """Trova tutti i percorsi tra start e end senza ripetere nodi."""
        def dfs(node, path, visited):
            if node == end:
                all_paths.append(path)
                return
            for neighbor in self.graph[node]:
                if neighbor not in visited:
                    dfs(neighbor, path + [neighbor], visited | {neighbor})
            for parent in self.parents[node]:
                if parent not in visited:
                    dfs(parent, path + [parent], visited | {parent})

        all_paths = []
        dfs(start, [start], {start})
        return all_paths

    def node_type(self, path, node):
        """Determina il tipo di nodo in un percorso: collider, chain o fork."""
        idx = path.index(node)
        if idx == 0 or idx == len(path) - 1:
            return None
        prev_node = path[idx - 1]
        next_node = path[idx + 1]
        if (prev_node, node) in self.edges and (next_node, node) in self.edges:
            return "collider"
        if (node, prev_node) in self.edges and (node, next_node) in self.edges:
            return "fork"
        return "chain"

    def is_path_active(self, path, conditioned):
        """Controlla se il percorso Ã¨ attivo dato il set di nodi condizionati."""
        for node in path[1:-1]:
            n_type = self.node_type(path, node)
            if n_type == "collider":
                if node in conditioned:
                    continue 
                else:
                    return False
            elif n_type in ("chain", "fork"):
                if node in conditioned:
                    return False  
        return True

def parse_edges(edges_str):
    return eval(edges_str)

def select_active_dags(log_file, start, end, conditioning_sets, exclude_dags):
    with open(log_file) as f:
        content = f.read()

    dag_blocks = re.split(r"DAG #\d+", content)[1:]
    dag_numbers = [int(num) for num in re.findall(r"DAG #(\d+)", content)]

    selected_dags = []

    for dag_num, block in zip(dag_numbers, dag_blocks):
        if dag_num in exclude_dags:
            continue
        edges_match = re.search(r"Edges:\s*(\[.*?\])", block, re.DOTALL)
        if not edges_match:
            continue
        edges = parse_edges(edges_match.group(1))
        dag = DAG(edges)

        paths = dag.all_paths(start, end)
        if not paths:
            continue

        for conditioned in conditioning_sets:
            if any(dag.is_path_active(path, conditioned) for path in paths):
                selected_dags.append(dag_num)
                break

    return selected_dags

if __name__ == "__main__":
    log_file = "3_D-SEPARATION/_logs/dag_structures.log"
    start, end = "ML", "PEG"
    conditioning_sets = [
        {"FRR", "ESM", "CHOL", "PDI"},
        {"ESM", "CHOL", "PDI"}
    ]
    exclude_dags = [0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 24, 25, 26, 27, 28, 30, 
                  31, 32, 33, 34, 36, 37, 38, 39, 40, 42, 49, 50, 51, 52, 58, 60, 61, 62, 68, 70, 71, 72, 73, 75, 
                  79, 80, 81, 83, 84, 85, 86, 87, 89, 90, 91, 92, 94, 95, 96, 97, 99, 130, 131, 132, 134, 139, 140, 
                  141, 142, 143, 144, 145, 147, 148, 149, 150, 151, 153, 184, 185, 186, 188, 193, 194, 195, 196, 197, 
                  198, 199, 200, 202, 203, 204, 205, 207, 208, 209, 210, 212, 218, 219, 220, 222, 1123, 1124, 1125, 1126, 
                  1127, 1128, 1130, 1131, 1132, 1133, 1134, 1135, 1136, 1137, 1138, 1139, 1140, 1141, 1142, 1143, 1144, 1145, 
                  1146, 1147, 1148, 1149, 1150, 1151, 1152, 1153, 1154, 1155, 1156, 1157, 1158, 1159, 1165, 1166, 1167, 1168, 
                  1174, 1175, 1176, 1177, 1183, 1184, 1185, 1186, 1187, 1189, 1192, 1193, 1194, 1195, 1196, 1197, 1198, 1199, 
                  1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1234, 1235, 1236, 1237, 1238, 1239, 1240, 1241, 1242, 
                  1243, 1244, 1245, 1246, 1247, 1248, 1249, 1250, 1276, 1277, 1278, 1279, 1280, 1281, 1282, 1283, 1284, 1285, 
                  1286, 1287, 1288, 1289, 1290, 1291, 1292, 1293, 1294, 1295, 1296, 1301, 1302, 1303, 1304, 1315, 1318, 1321, 
                  1324, 1327, 1330, 1344, 1345, 1346, 1347, 1361, 1362, 1363, 1364, 1378, 1379, 1380, 1381, 1395, 1396, 1397, 
                  1398, 1412, 1413, 1414, 1415, 1429, 1430, 1431, 1432, 1441, 1444, 1447, 1450, 1470, 1472, 1475, 1478, 1498, 
                  1500, 1503, 1506, 1509, 1513, 1527, 1528, 1529, 1543, 1544, 1545, 1546, 1558, 1559, 1560, 1572, 1573, 1574, 
                  1675, 1676, 1677, 1682, 1683, 1684, 1695, 1696, 1697, 1711, 1712, 1713, 1714, 1815, 1816, 1817, 1822, 1823, 
                  1824, 1837, 1838, 1839, 1840, 1852, 1853, 1854, 1866, 1867, 1868, 1884, 1885, 1886, 5694, 5695, 5696, 5697, 
                  5698, 5699, 5701, 5702, 5703, 5704, 5706, 5707, 5708, 5709, 5710, 5712, 5713, 5714, 5715, 5716, 5718, 5719, 
                  5720, 5721, 5722, 5724, 5725, 5726, 5727, 5728, 5730, 5731, 5732, 5733, 5734, 5736, 5743, 5744, 5745, 5746, 
                  5752, 5754, 5755, 5756, 5762, 5764, 5765, 5766, 5767, 5769, 5773, 5774, 5775, 5777, 5778, 5779, 5780, 5781, 
                  5783, 5784, 5785, 5786, 5788, 5789, 5790, 5791, 5793, 5824, 5825, 5826, 5828, 5833, 5834, 5835, 5836, 5837, 
                  5838, 5839, 5841, 5842, 5843, 5844, 5845, 5847, 5878, 5879, 5880, 5882, 5887, 5888, 5889, 5890, 5891, 5892, 
                  5893, 5894, 5896, 5897, 5898, 5899, 5901, 5902, 5903, 5904, 5906, 5912, 5913, 5914, 5916, 8153, 8154, 8155, 
                  8156, 8157, 8158, 8160, 8161, 8162, 8163, 8164, 8165, 8166, 8167, 8168, 8169, 8170, 8171, 8172, 8173, 8174, 
                  8175, 8176, 8177, 8178, 8179, 8180, 8181, 8182, 8183, 8188, 8189, 8190, 8191, 8192, 8193, 8194, 8195, 8196, 
                  8197, 8198, 8199, 8200, 8201, 8202, 8203, 8204, 8205, 8209, 8210, 8211, 8212, 8213, 8214, 8215, 8216, 8217, 
                  8218, 8219, 8220, 8221, 8222, 8223, 8224, 8225, 8226, 8227, 8228, 8229, 8230, 8231, 8232, 8233, 8234, 8235, 
                  8236, 8237, 8238, 8239, 8240, 8241, 8242, 8243, 8244, 8245, 8246, 8247, 8248, 8249, 8250, 8251, 8252, 8253, 
                  8254, 8255, 8256, 8265, 8266, 8267, 8268, 8274, 8275, 8276, 8282, 8283, 8284, 8285, 8287, 8289, 8290, 8291, 
                  8292, 8293, 8294, 8295, 8296, 8297, 8298, 8299, 8300, 8301, 8322, 8323, 8324, 8325, 8326, 8327, 8328, 8329, 
                  8330, 8331, 8352, 8353, 8354, 8355, 8356, 8357, 8358, 8359, 8360, 8361, 8362, 8363, 8364, 8368, 8369, 8370, 
                  8374, 8375, 8376, 8377, 8378, 8379, 8380, 8381, 8382, 8398, 8399, 8400, 8401, 8402, 8403, 8404, 8420, 8421, 
                  8422, 8423, 8424, 8425, 8426, 8427, 8428, 8431, 8432, 8435, 8436, 8437, 8438, 8439, 8440, 8441, 8442, 8483, 
                  8484, 8485, 8486, 8487, 8488, 8489, 8490, 8531, 8532, 8533, 8534, 8535, 8536, 8537, 8538, 8541, 8544, 8547, 
                  8550, 8553, 8556, 8566, 8567, 8568, 8569, 8578, 8579, 8580, 8581, 8590, 8591, 8592, 8593, 8602, 8603, 8604, 
                  8605, 8614, 8615, 8616, 8617, 8626, 8627, 8628, 8629, 8642, 8643, 8653, 8654, 8664, 8665, 8675, 8676, 8686, 
                  8687, 8697, 8698, 8721, 8722, 8723, 8724, 8725, 8726, 8727, 8747, 8748, 8749, 8750, 8751, 8752, 8753, 8773, 
                  8774, 8775, 8776, 8777, 8778, 8779, 8799, 8800, 8801, 8802, 8803, 8804, 8805, 8825, 8826, 8827, 8828, 8829, 
                  8830, 8831, 8851, 8852, 8853, 8854, 8855, 8856, 8857, 8869, 8872, 8875, 8878, 8897, 8900, 8903, 8922, 8925, 
                  8928, 8931, 8935, 8944, 8945, 8946, 8955, 8956, 8957, 8958, 8965, 8966, 8967, 8974, 8975, 8976, 9044, 9045, 
                  9046, 9053, 9054, 9055, 9064, 9065, 9066, 9067, 9135, 9136, 9137, 9146, 9147, 9148, 9149, 9156, 9157, 9158, 
                  9165, 9166, 9167, 9177, 9178, 9179, 9192, 9202, 9203, 9211, 9219, 9277, 9284, 9294, 9295, 9353, 9362, 9363, 
                  9371, 9379, 9389, 9411, 9412, 9413, 9414, 9415, 9416, 9417, 9549, 9550, 9551, 9552, 9553, 9554, 9555, 9687, 
                  9688, 9689, 9690, 9691, 9692, 9693, 13975, 13977, 13978, 13979, 13980, 13982, 13989, 13993, 13994, 13995, 
                  13997, 14083, 14085, 14086, 14087, 14088, 14089, 14095, 14098, 14099, 14100, 14101, 14112, 14126, 14127, 
                  14128, 14129, 14138, 14152, 14153, 14154, 14413, 14415, 14416, 14417, 14418, 14420, 14427, 14431, 14432, 
                  14433, 14435, 14614, 14616, 14617, 14618, 14619, 14624, 14625, 14626, 14630, 14631, 14632, 14633, 14634, 
                  14635, 14636, 14637, 14646, 14648, 14649, 14650, 14654, 14655, 14660, 14670, 14671, 14672, 14673, 14686, 
                  14687, 14710, 14711, 14712, 14713, 14714, 14715, 14716, 14728, 14737, 14738, 14739, 14752, 14993, 14994, 
                  14995, 14996, 14998, 14999, 15000, 15001, 15002, 15008, 15009, 15010, 15011, 15013, 15014, 15015, 15016, 
                  15017, 15019, 15020, 15021, 15022, 15023, 15025, 15026, 15027, 15028, 15029, 15031, 15038, 15039, 15040, 
                  15041, 15043, 15044, 15045, 15046, 15047, 15049, 15050, 15051, 15052, 15053, 15055, 15056, 15057, 15058, 
                  15059, 15061, 15062, 15063, 15064, 15065, 15067, 15068, 15069, 15075, 15077, 15078, 15079, 15080, 15081, 
                  15082, 15083, 15084, 15085, 15086, 15088, 15089, 15090, 15091, 15093, 15094, 15095, 15096, 15098, 15128, 
                  15129, 15130, 15132, 15137, 15138, 15139, 15140, 15141, 15142, 15143, 15145, 15146, 15147, 15148, 15150, 
                  15151, 15152, 15153, 15155, 15156, 15157, 15158, 15160, 15161, 15162, 15163, 15165, 15167, 15168, 15169, 
                  15171, 15173, 15174, 15175, 15177, 15179, 15180, 15181, 15183, 15184, 15185, 15186, 15188, 15193, 15194, 
                  15195, 15196, 15277, 15278, 15279, 15280, 15282, 15283, 15284, 15285, 15286, 15288, 15289, 15290, 15291, 
                  15293, 15294, 15295, 15296, 15297, 15299, 15313, 15314, 15315, 15317, 15319, 15320, 15321, 15323, 15325, 
                  15326, 15327, 15329, 15330, 15331, 15332, 15333, 15335, 15340, 15341, 15342, 15343, 15344, 15345, 15346, 
                  15347, 15349, 15422, 15423, 15424, 15426, 15428, 15429, 15430, 15432, 15434, 15435, 15436, 15438, 15439, 
                  15440, 15441, 15442, 15444, 15449, 15450, 15451, 15452, 16937, 16938, 16939, 16940, 16942, 16943, 16944, 
                  16945, 16946, 16951, 16952, 16953, 16954, 16955, 16956, 16957, 16958, 16959, 16960, 16961, 16962, 16963, 
                  16964, 16965, 16966, 16967, 16968, 16969, 16970, 16976, 16977, 16978, 16979, 16980, 16981, 16982, 16983, 
                  16984, 16985, 16986, 16987, 16988, 16989, 16990, 16991, 16992, 16993, 16994, 16995, 16996, 16997, 16998, 
                  16999, 17000, 17001, 17002, 17008, 17009, 17010, 17011, 17012, 17013, 17014, 17015, 17016, 17017, 17018, 
                  17019, 17020, 17021, 17022, 17023, 17024, 17025, 17026, 17027, 17052, 17053, 17054, 17055, 17056, 17057, 
                  17058, 17059, 17060, 17061, 17062, 17063, 17064, 17065, 17066, 17067, 17068, 17069, 17070, 17071, 17072, 17073, 17074, 17075, 17076, 17077, 17078, 17079, 17081, 17082, 
                  17083, 17084, 17086, 17087, 17088, 17089, 17091, 17092, 17093, 17094, 17095, 17096, 17097, 17098, 17099, 17100, 17101, 17102, 
                  17103, 17104, 17105, 17106, 17107, 17108, 17109, 17110, 17111, 17112, 17113, 17114, 17115, 17116, 17117, 17118, 17119, 17120, 
                  17121, 17133, 17134, 17135, 17136, 17138, 17139, 17140, 17141, 17143, 17144, 17145, 17146, 17147, 17148, 17149, 17150, 17151, 
                  17152, 17153, 17154, 17155, 17156, 17157, 17158, 17159, 17160, 17218, 17219, 17220, 17221, 17223, 17224, 17225, 17226, 17228, 
                  17229, 17230, 17231, 17232, 17233, 17234, 17235, 17236, 17237, 17238, 17239, 17240, 17244, 17247, 17250, 17253, 17257, 17260, 
                  17263, 17266, 17267, 17268, 17269, 17286, 17287, 17288, 17289, 17303, 17304, 17305, 17306, 17320, 17321, 17322, 17323, 17337, 
                  17338, 17339, 17340, 17359, 17360, 17361, 17362, 17376, 17377, 17378, 17379, 17393, 17394, 17395, 17396, 17410, 17411, 17412, 
                  17413, 17415, 17416, 17417, 17418, 17421, 17422, 17423, 17424, 17427, 17428, 17429, 17430, 17434, 17437, 17457, 17459, 17462, 
                  17463, 17464, 17465, 17466, 17467, 17468, 17469, 17470, 17471, 17472, 17473, 17474, 17475, 17476, 17477, 17478, 17479, 17480, 
                  17481, 17482, 17484, 17485, 17487, 17488, 17490, 17501, 17502, 17503, 17515, 17516, 17517, 17617, 17618, 17619, 17624, 17625, 
                  17626, 17637, 17638, 17639, 17641, 17642, 17643, 17646, 17647, 17648, 17651, 17652, 17653, 17655, 17656, 17657, 17660, 17661, 
                  17662, 17665, 17666, 17667, 17669, 17670, 17671, 17674, 17675, 17676, 17679, 17680, 17681, 17683, 17684, 17685, 17688, 17689, 
                  17690, 17693, 17694, 17695, 17698, 17699, 17700, 17703, 17704, 17705, 17709, 17710, 17711, 17715, 17716, 17717, 17720, 17721, 
                  17722, 17726, 17727, 17728, 17732, 17733, 17734, 17736, 17737, 17738, 17745, 17746, 17747, 17749, 17750, 17751, 17758, 17759, 
                  17760, 17762, 17763, 17764, 17769, 17770, 17771, 17991, 17992, 17993, 17997, 17998, 17999, 18002, 18003, 18004, 18005, 18007, 
                  18020, 18021, 18022, 18023, 18025, 18036, 18037, 18038, 18040, 18042, 18043, 18044, 18048, 18049, 18050, 18053, 18054, 18055, 
                  18056, 18058, 18096, 18097, 18098, 18100, 18102, 18103, 18104, 18108, 18109, 18110, 18114, 18115, 18116, 18118, 18120, 18121, 
                  18122, 18126, 18127, 18128, 18132, 18133, 18134, 18136, 18137, 18138, 18139, 18140, 18147, 18148, 18149, 18151, 18152, 18153, 
                  18154, 18161, 18162, 18163, 18165, 18166, 18167, 18168, 18170, 18175, 18176, 18177, 18178, 18180, 18181, 18182, 18186, 18187, 
                  18188, 18191, 18192, 18193, 18194, 18196, 18389, 18390, 18391, 18393, 18395, 18396, 18397, 18401, 18402, 18403, 18407, 18408, 
                  18409, 18411, 18413, 18414, 18415, 18417, 18418, 18419, 18420, 18421, 18423, 18428, 18429, 18430, 18431, 19468, 19469, 19473, 
                  19474, 19479, 19480, 19482, 19483, 19621, 19622, 19623, 19625, 19626, 19627, 19641, 19642, 19643, 19645, 19646, 19647, 19665, 
                  19666, 19667, 19669, 19670, 19671, 19677, 19678, 19679, 19681, 19682, 19683, 19709, 19710, 19711, 19714, 19715, 19716, 19779, 
                  19780, 19781, 19784, 19785, 19786, 19837, 19838, 19839, 19840, 19842, 19843, 19844, 19846, 19847, 19848, 19849, 19851, 19852, 
                  19853, 19871, 19872, 19873, 19876, 19877, 19878, 23629, 23630, 23631, 23632, 23634, 23635, 23636, 23637, 23638, 23644, 23645, 
                  23646, 23647, 23649, 23650, 23651, 23652, 23653, 23655, 23656, 23657, 23658, 23659, 23661, 23662, 23663, 23664, 23665, 23667, 
                  23674, 23675, 23676, 23677, 23679, 23680, 23681, 23682, 23683, 23685, 23686, 23687, 23688, 23689, 23691, 23692, 23693, 23694, 
                  23695, 23697, 23698, 23699, 23700, 23701, 23703, 23704, 23705, 23711, 23713, 23714, 23715, 23716, 23717, 23718, 23719, 23720, 
                  23721, 23722, 23724, 23725, 23726, 23727, 23729, 23730, 23731, 23732, 23734, 23764, 23765, 23766, 23768, 23773, 23774, 23775, 
                  23776, 23777, 23778, 23779, 23781, 23782, 23783, 23784, 23786, 23787, 23788, 23789, 23791, 23792, 23793, 23794, 23796, 23797, 
                  23798, 23799, 23801, 23803, 23804, 23805, 23807, 23809, 23810, 23811, 23813, 23815, 23816, 23817, 23819, 23820, 23821, 23822, 
                  23824, 23829, 23830, 23831, 23832, 23956, 23957, 23958, 23959, 23961, 23962, 23963, 23964, 23965, 23967, 23968, 23969, 23970, 
                  23972, 23973, 23974, 23975, 23976, 23978, 23992, 23993, 23994, 23996, 23998, 23999, 24000, 24002, 24004, 24005, 24006, 24008, 
                  24009, 24010, 24011, 24012, 24014, 24019, 24020, 24021, 24022, 24023, 24024, 24025, 24026, 24028, 24101, 24102, 24103, 24105, 
                  24107, 24108, 24109, 24111, 24113, 24114, 24115, 24117, 24118, 24119, 24120, 24121, 24123, 24128, 24129, 24130, 24131, 27612, 
                  27613, 27614, 27615, 27617, 27618, 27619, 27620, 27621, 27625, 27626, 27627, 27628, 27629, 27630, 27631, 27632, 27633, 27634, 
                  27635, 27636, 27637, 27638, 27639, 27640, 27645, 27646, 27647, 27648, 27649, 27650, 27651, 27652, 27653, 27654, 27655, 27656, 
                  27657, 27658, 27659, 27660, 27661, 27662, 27663, 27664, 27667, 27668, 27669, 27670, 27671, 27672, 27673, 27674, 27675, 27676, 
                  27677, 27678, 27682, 27683, 27684, 27685, 27686, 27687, 27688, 27689, 27690, 27691, 27692, 27693, 27694, 27695, 27696, 27697, 
                  27698, 27699, 27700, 27701, 27702, 27703, 27704, 27705, 27706, 27707, 27708, 27709, 27710, 27711, 27712, 27713, 27714, 27715, 
                  27716, 27717, 27718, 27719, 27720, 27721, 27722, 27723, 27724, 27725, 27726, 27727, 27728, 27737, 27738, 27739, 27740, 27741, 
                  27742, 27743, 27744, 27745, 27746, 27747, 27748, 27749, 27750, 27751, 27752, 27753, 27754, 27755, 27756, 27757, 27758, 27759, 
                  27760, 27761, 27762, 27763, 27764, 27765, 27766, 27767, 27768, 27769, 27770, 27771, 27772, 27773, 27774, 27775, 27776, 27777, 
                  27778, 27784, 27785, 27786, 27787, 27788, 27789, 27790, 27791, 27792, 27793, 27794, 27795, 27796, 27797, 27798, 27799, 27819, 
                  27820, 27821, 27822, 27823, 27824, 27825, 27826, 27827, 27828, 27829, 27830, 27831, 27832, 27833, 27834, 27835, 27836, 27838, 
                  27839, 27840, 27842, 27843, 27844, 27846, 27847, 27848, 27849, 27850, 27851, 27852, 27853, 27854, 27855, 27870, 27871, 27872, 
                  27873, 27874, 27875, 27876, 27877, 27878, 27879, 27880, 27881, 27883, 27884, 27886, 27887, 27889, 27890, 27891, 27892, 27893, 
                  27894, 27895, 27896, 27897, 27898, 27899, 27900, 27901, 27902, 27903, 27904, 27905, 27906, 27907, 27908, 27909, 27910, 27911, 
                  27912, 27913, 27914, 27915, 27916, 27917, 27918, 27919, 27920, 27921, 27922, 27923, 27924, 27925, 27926, 27927, 27928, 27959, 
                  27960, 27961, 27970, 27971, 27972, 27981, 27982, 27983, 27984, 27985, 27986, 27987, 27988, 27989, 27990, 27991, 27992, 27993, 
                  27994, 27995, 27996, 27997, 27998, 27999, 28000, 28001, 28002, 28003, 28004, 28005, 28111, 28112, 28113, 28122, 28123, 28124, 
                  28133, 28134, 28135, 28136, 28137, 28138, 28139, 28140, 28141, 28142, 28143, 28144, 28145, 28146, 28150, 28153, 28156, 28159, 
                  28163, 28166, 28169, 28172, 28173, 28174, 28175, 28187, 28188, 28189, 28190, 28199, 28200, 28201, 28202, 28211, 28212, 28213, 
                  28214, 28223, 28224, 28225, 28226, 28239, 28240, 28241, 28242, 28251, 28252, 28253, 28254, 28263, 28264, 28265, 28266, 28275, 
                  28276, 28277, 28278, 28279, 28280, 28281, 28282, 28283, 28284, 28285, 28286, 28287, 28288, 28289, 28290, 28301, 28302, 28312, 
                  28313, 28323, 28324, 28334, 28335, 28348, 28349, 28359, 28360, 28370, 28371, 28381, 28382, 28384, 28385, 28388, 28389, 28392, 
                  28393, 28413, 28414, 28415, 28416, 28417, 28418, 28419, 28439, 28440, 28441, 28442, 28443, 28444, 28445, 28465, 28466, 28467, 
                  28468, 28469, 28470, 28471, 28491, 28492, 28493, 28494, 28495, 28496, 28497, 28525, 28526, 28527, 28528, 28529, 28530, 28531, 
                  28551, 28552, 28553, 28554, 28555, 28556, 28557, 28577, 28578, 28579, 28580, 28581, 28582, 28583, 28603, 28604, 28605, 28606, 
                  28607, 28608, 28609, 28611, 28612, 28613, 28614, 28615, 28616, 28617, 28620, 28621, 28622, 28623, 28624, 28625, 28626, 28629, 
                  28630, 28631, 28632, 28633, 28634, 28635, 28639, 28642, 28661, 28664, 28665, 28666, 28667, 28668, 28669, 28670, 28671, 28672, 
                  28673, 28674, 28675, 28676, 28677, 28678, 28679, 28680, 28681, 28682, 28683, 28685, 28687, 28689, 28696, 28697, 28698, 28705, 
                  28706, 28707, 28774, 28775, 28776, 28783, 28784, 28785, 28786, 28787, 28788, 28789, 28790, 28791, 28792, 28793, 28794, 28795, 
                  28796, 28797, 28798, 28799, 28800, 28801, 28802, 28803, 28804, 28805, 28806, 28807, 28808, 28809, 28810, 28811, 28812, 28813, 
                  28814, 28815, 28816, 28817, 28818, 28819, 28820, 28821, 28823, 28824, 28825, 28827, 28828, 28829, 28831, 28832, 28833, 28835, 
                  28836, 28837, 28839, 28840, 28841, 28843, 28844, 28845, 28847, 28848, 28849, 28853, 28854, 28855, 28859, 28860, 28861, 28865, 
                  28866, 28867, 28874, 28882, 28939, 28946, 28948, 28951, 28954, 28956, 28959, 28962, 28964, 28967, 28970, 28972, 28975, 28978, 
                  28981, 28984, 28988, 28992, 28995, 28999, 29003, 29007, 29011, 29014, 29805, 29806, 29807, 29817, 29818, 29819, 29820, 29821, 
                  29822, 29823, 29824, 29825, 29826, 29828, 29829, 29830, 29831, 29856, 29857, 29858, 29859, 29860, 29861, 29862, 29864, 29865, 
                  29866, 29867, 29874, 29875, 29876, 29886, 29887, 29888, 29898, 29899, 29900, 29901, 29902, 29903, 29904, 29905, 29906,
                    29907, 29909, 29910, 29911, 29912, 29994, 29995, 29996, 30006, 30007, 30008, 30018, 30019, 30020, 30030, 30031, 30032, 30042, 
                    30043, 30044, 30054, 30055, 30056, 30066, 30067, 30068, 30069, 30070, 30071, 30072, 30073, 30074, 30075, 30081, 30082, 30083, 
                    30084, 30085, 30086, 30087, 30088, 30089, 30090, 30096, 30097, 30098, 30099, 30100, 30101, 30102, 30103, 30104, 30105, 30107, 
                    30111, 30112, 30113, 30123, 30124, 30125, 30135, 30136, 30137, 30138, 30139, 30140, 30141, 30142, 30143, 30144, 30146, 30147, 
                    30148, 30149, 30453, 30454, 30455, 30465, 30466, 30467, 30477, 30478, 30479, 30489, 30490, 30491, 30501, 30502, 30503, 30504, 
                    30505, 30506, 30507, 30508, 30509, 30510, 30512, 30516, 30517, 30518, 32651, 32652, 32656, 32657, 32662, 32663, 32665, 32666, 
                    32762, 32763, 32764, 32765, 32766, 32767, 32777, 32778, 32779, 32780, 32781, 32782, 32795, 32796, 32797, 32798, 32799, 32800, 
                    32804, 32805, 32806, 32807, 32808, 32809, 32878, 32880, 32888, 32890, 32900, 32902, 32906, 32908, 32953, 32954, 32955, 32964, 
                    32965, 32966, 33078, 33079, 33080, 33089, 33090, 33091, 33191, 33192, 33193, 33194, 33195, 33196, 33197, 33199, 33200, 33201, 
                    33202, 33203, 33204, 33205, 33206, 33207, 33208, 33210, 33211, 33212, 33254, 33255, 33256, 33265, 33266, 33267]

    active_dags = select_active_dags(log_file, start, end, conditioning_sets, exclude_dags)
    print("DAG selezionati:", active_dags)
